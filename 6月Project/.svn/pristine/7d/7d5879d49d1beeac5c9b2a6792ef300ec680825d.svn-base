using GK.Common;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Text;

namespace GK.WCS.DAL
{
    public static class ServerFactray
    {

        public const GKDBType prefixal = GKDBType.sqlserver;
        static Dictionary<Type, Object> dict = new Dictionary<Type, Object>();
        public static T getServer<T>()
        {
            Type type = typeof(T);
            if (dict.ContainsKey(type)) {
                return (T)dict[type];
            }

            String fullName = type.FullName;
          
            int index = fullName.LastIndexOf(".") + 1;
            String dllName = fullName.Substring(0, index) + prefixal + "." + fullName.Substring(index + 1);
            Type implType = Type.GetType(dllName);//加载类型
            if (implType == null) {
                return default(T);
            }
            T t = (T)Activator.CreateInstance(implType);

            dict.Add(type, t);
            return t;
        }
    }
}
