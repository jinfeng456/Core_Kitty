using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using GK.Mongon.DAL;
using GK.Mongon.entity;
using MongoDB.Bson;
using MongoDB.Driver;
using MongoDB.Driver.Builders;
using Newtonsoft.Json;

namespace GK.Mongon
{
   public  class WcsEquipmentUtil {

      

        public static void deleteEquipmentStatus(Equipment equipment) {
            var collection = MongonBaseDAL.database.GetCollection<BsonDocument>("wcsEquipment");
            DateTime da = DateTime.Now;
            DateTime begin = new DateTime(da.Year - 1,da.Month,da.Day);
            IMongoQuery query = Query.LTE("time",begin);
            collection.Remove(query);
        }

        public static void saveEquipmentStatus(Equipment equipment) {
            if(equipment.list.Count() == 0) {
                return;
            }
            var collection = MongonBaseDAL.database.GetCollection<BsonDocument>("wcsEquipment");
            BsonDocument document = BsonDocument.Parse(JsonConvert.SerializeObject(equipment));
            collection.Insert(document);
        
       }

     

        
       
    }
}
