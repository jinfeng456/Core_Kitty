using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Security.Principal;
using System.Web;
using System.Web.Http;
using System.Web.Security;
using Hx.Wms.Domain;
using HY.WCS.DAL;
using Web.Authorize;

namespace WebApi {
    [FormAuthenticationFilter]
    [RoutePrefix("api/menu")]
    public class MenuController:BaseApiController {
        [HttpGet, Route("getMenu")]
        public BaseResult getMenu() {

            GenericPrincipal principal = (GenericPrincipal)HttpContext.Current.User;
            FormsIdentity identity = (FormsIdentity)principal.Identity;
            FormsAuthenticationTicket ticket = identity.Ticket;
            String userid = ticket.UserData;
            List<Menu> list = new List<Menu>();
            Menu munu = new Menu("系统管理","");
            munu.add(new Menu("管理员列表","User/admin-list.html"));
            munu.add(new Menu("权限列表", "User/frm_RoleSys.html"));
            munu.add(new Menu("WMS日志","sys/logger/wmsLoger.html"));
            munu.add(new Menu("webserver日志","sys/logger/webserverLoger.html"));
            munu.add(new Menu("wcs日志","sys/logger/wcsLoger.html"));
            munu.add(new Menu("系统参数","sys/sysParam.html"));
            list.Add(munu);
            Menu  munugq = new Menu("光纤库管理","");
            munugq.add(new Menu("库位管理","wh/location.html"));
            munugq.add(new Menu("光纤管理", "Guangxian/GxInformationService.html"));
            munugq.add(new Menu("光纤订单管理", "Guangxian/gxSelectionPage.html"));
            munugq.add(new Menu("光纤MES订单管理", "  Guangxian/gxMesSelectionPage.html"));
            list.Add(munugq);
            Menu munuzx = new Menu("纸箱库管理","");
            munuzx.add(new Menu("纸箱管理","wh/ZhiXiang/zxPage.html"));
            munuzx.add(new Menu("订单管理","wh/ZhiXiang/zxSelectionPage.html"));
            list.Add(munuzx);
            Menu munuTask = new Menu("任务管理","");
            munuTask.add(new Menu("任务查询","RenWu/TaskQuery.html"));
            munuTask.add(new Menu("历史任务查询", "RenWu/History.html"));
            list.Add(munuTask);
            return new BaseResult(list);
        }
    }

    public class Menu{

        public Menu(String name, String path)
        {
            this.name = name;
            this.path = path;
        }

        public void add(Menu m) {
            if(children == null) {
                children = new List<Menu>();
            }
            children.Add(m);
        }
       public String name;
        public String path;
        public List<Menu> children;
    }
}
