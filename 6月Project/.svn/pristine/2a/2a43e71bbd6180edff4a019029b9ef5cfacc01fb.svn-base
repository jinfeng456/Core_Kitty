using System;
using CMNetLib.Robots.Crane;
using GK.WCS.Open.http.dto;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;

namespace GK.WCS.Client.Station {
    public class HttpCraneUtil {


       public static  CraneData loadData(int  CraneId) {
            JObject data = HttpUtil.getObject("Crane/craneStates/" + CraneId);
            if(data == null) {
                return null;
            }
            CraneData craneData = JsonConvert.DeserializeObject<CraneData>(data.ToString());
            return craneData;
        }

        ///Crane/IsAutoRunning/craneId/
        static public bool IsAutoRunning(int CraneId) {
            JValue data = HttpUtil.getJValue("Crane/IsAutoRunning/" + CraneId);
            if(data == null) {
                return false;
            }
            return bool.Parse(data.ToString());

        }
        ///Crane/ClearTaskState/craneId/forkNo
        static public bool ClearTaskState(int CraneId,int forkNo) {
            JValue data = HttpUtil.getJValue("Crane/ClearTaskState/" + CraneId+"/"+ forkNo);
            if(data == null) {
                return false;
            }
            var res= bool.Parse(data.Value.ToString());
            return res;
        }


        ///Crane/ManualAction/craneId/ManualActionCode
        static public bool ManualAction(int CraneId,int forkNo ,ManualActionCode code) {
            JValue data = HttpUtil.getJValue("Crane/ManualAction/" + CraneId + "/" + (int)forkNo+"/"+ (int)code);
            if(data == null) {
                return false;
            }
            return bool.Parse(data.ToString());


        }
        ///Crane/ReConnectRobot/craneId/mode
        static  public bool EmergencyStop(int CraneId,RobotMode mode) {
            JValue data = HttpUtil.getJValue("Crane/EmergencyStop/" + CraneId + "/" + (int)mode);
            if(data == null) {
                return false;
            }
            return bool.Parse(data.ToString());

        }

        ///Crane/ReConnectRobot/craneId/mode
        static  public bool SwtichMode(int CraneId,RobotMode mode) {
            JValue data = HttpUtil.getJValue("Crane/SwtichMode/" + CraneId + "/" + (int)mode);
            if(data == null) {
                return false;
            }
            return bool.Parse(data.ToString());

        }
        ///Crane/ReConnectRobot/craneId
        static public bool ReConnectRobot(int CraneId) {
            JValue data = HttpUtil.getJValue("Crane/ReConnectRobot/" + CraneId );
            if(data == null) {
                return false;
            }
            return bool.Parse(data.ToString());

        }


        ///Crane/ClearFault/craneId
        static public string ClearFault(int CraneId) {
            JValue data = HttpUtil.getJValue("Crane/ClearFault/" + CraneId);
            if(data == null) {
                return "网络异常";
            }
            return data.ToString();

        }
        static public string reset(int CraneId) {
            JValue data = HttpUtil.getJValue("Crane/reset/" + CraneId);
            if(data == null) {
                return "网络异常";
            }
            return data.ToString();

        }
        

        ///Crane/sendTask/craneId/forkNo/src/des/actionid
        static public bool sendTask(int craneId,int forkNo,String src, int actionid,int lenType) {
            JValue data = HttpUtil.getJValue("Crane/sendTask/" + craneId + "/"+ forkNo+"/"+ src+"/"+ actionid+"/"+ lenType);

            if(data == null) {
                return false;
            }
            return bool.Parse(data.ToString());
        }
       

  

       

       
    }
}
