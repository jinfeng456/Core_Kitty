using System;
using System.Collections.Generic;
using System.Net;

namespace GK.WCS.Common {
    public abstract class ZtTaskConnect: ZtTask {
        public String ip;
        public String port;

        public ZtTaskConnect():base() {
            time = 11000;
        }

        public override void onlyOneTime() {
            reConnect();
        }
        public abstract void forceDisConnection();

        public abstract void newConnection();
        public abstract bool noConn();
        protected List<IPEndPoint> IPEndPoints = new List<IPEndPoint>();
        protected String[] ports;
        sealed   public override void excute() {
      
            bool re  =reConnect();
            if(re) {
                LoggerCommon.consol(className + ip + ":" + port + "执行连接");
            }

        }

        abstract public bool reConnect();
        public override bool init() {
            base.init();
            ports = port.Split(',');
            foreach(String p in ports) {
                IPAddress addr = IPAddress.Parse(ip);
                IPEndPoints.Add(new IPEndPoint(addr,int.Parse(p)));
            }
            return true;
        }




    }
}
