using GK.Common;
using Oracle.DataAccess.Client;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;
using System.Text;

namespace GK.WCS.DAL {
    public class DBUtils {
        private static IDbConnection WCSConnection = null;
        static DBUtils() {
            Dapper.DefaultTypeMap.MatchNamesWithUnderscores = true;
        }
        public static IDbConnection CreateWCSConnection(GKDBType type) {
            if (WCSConnection != null) {
                return WCSConnection;
            }
            WCSConnection = CreateNewWCSConnection(type);
            return WCSConnection;
        }




        public static IDbConnection CreateNewWCSConnection(GKDBType type) {
            IDbConnection connection = null;
            if (type == GKDBType.sqlserver) {
                ConnectionStringSettings connectionStringSettings = ConfigurationManager.ConnectionStrings["DB_WCS"];
                connection =
                   DbProviderFactories.GetFactory(connectionStringSettings.ProviderName).CreateConnection();
                connection.ConnectionString = connectionStringSettings.ConnectionString;

            }
            if (type == GKDBType.oracle) {
                ConnectionStringSettings connectionStringSettings = ConfigurationManager.ConnectionStrings["DB_WCS"];
                connection = new OracleConnection(connectionStringSettings.ConnectionString);

            }

            connection.Open();
            return connection;
        }

    }
}
